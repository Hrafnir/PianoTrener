<!-- Version: #36 -->
<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Piano L√¶rer - Pro</title>
    <!-- Biblioteker -->
    <script src="https://unpkg.com/vexflow@3.0.9/releases/vexflow-min.js"></script>
    <script src="https://unpkg.com/tone"></script>
    <script src="https://unpkg.com/@tonejs/midi"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="app-container">
        <header>
            <h1>Piano L√¶rer üéπ</h1>
            <p>Spill, komponer og l√¶r rytme!</p>
        </header>

        <section id="controls">
            <!-- Mikrofon-seksjon -->
            <div class="control-group">
                <h3>Fri Modus / Mikrofon</h3>
                <button id="btn-start-mic">Start Mikrofon</button>
                <div id="status-display">Status: Klar...</div>
                <div id="note-display">Note: --</div>
            </div>

            <hr class="divider">

            <!-- MIDI √òvelsesmodus -->
            <div class="control-group" id="midi-exercise-section">
                <h3>üéì MIDI √òvelsesmodus (Falling Notes)</h3>
                <div class="button-row">
                    <input type="file" id="midi-upload" accept=".mid,.midi" style="display: none;">
                    <button id="btn-upload-midi" onclick="document.getElementById('midi-upload').click()" style="background-color: #673ab7;">üìÅ Last opp MIDI</button>
                    <button id="btn-start-midi" disabled style="background-color: #4caf50;">‚ñ∂Ô∏è Start Sang</button>
                    <button id="btn-pause-midi" disabled style="background-color: #ff9800;">‚è∏ Pause</button>
                    <button id="btn-stop-midi" disabled style="background-color: #f44336;">‚èπ Stopp</button>
                </div>
                <div id="midi-info">Ingen fil valgt</div>
            </div>

            <hr class="divider">

            <!-- Musikkinnstillinger -->
            <div class="control-group">
                <h3>Musikkinnstillinger</h3>
                <div class="settings-row">
                    <div class="setting-item">
                        <label>Tempo (BPM):</label>
                        <input type="number" id="bpm-input" value="100" min="40" max="240">
                    </div>
                    <div class="setting-item">
                        <label>Taktart:</label>
                        <select id="time-sig-input">
                            <option value="4/4" selected>4/4</option>
                            <option value="3/4">3/4</option>
                            <option value="2/4">2/4</option>
                            <option value="6/8">6/8</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label>Metronom:</label>
                        <button id="btn-toggle-metronome" class="toggle-btn">Av</button>
                    </div>
                </div>
            </div>

            <!-- Tonelengde & Redigering -->
            <div class="control-group">
                <h3>Noteverdi (1-9), Punktum (.), Angre (Z), Pause (P)</h3>
                <div id="duration-controls">
                    <div class="duration-btn" data-dur="w" id="dur-1">1 Hel</div>
                    <div class="duration-btn" data-dur="h" id="dur-2">2 Halv</div>
                    <div class="duration-btn active" data-dur="q" id="dur-4">4 Fjerd.</div>
                    <div class="duration-btn" data-dur="8" id="dur-8">8 √Ötte.</div>
                    <div class="duration-btn" data-dur="16" id="dur-9">16-del</div>
                    
                    <div class="duration-btn dot-btn" id="btn-toggle-dot">. Punktert</div>
                    <div class="duration-btn rest-btn" id="btn-add-rest">‚è∏ Pause</div>
                    <div class="duration-btn undo-btn" id="btn-undo">‚Ü© Angre</div>
                </div>
            </div>

            <hr class="divider">

            <!-- Handlinger -->
            <div class="control-group">
                <div id="main-controls" class="button-row">
                    <button id="btn-record">‚è∫ Start Opptak</button>
                    <button id="btn-play-seq" disabled>‚ñ∂Ô∏è Spill Av</button>
                    <button id="btn-challenge" disabled>üéì √òvelse</button>
                    <button id="btn-clear-sheet" style="background-color: #6c757d;">üóëÔ∏è Nytt Ark</button>
                    <button id="btn-download" style="background-color: #009688;">üíæ Lagre</button>
                </div>

                <div id="game-controls" class="button-row" style="display: none;">
                    <button id="btn-restart-game" style="background-color: #ff9800;">üîÑ Start P√• Nytt</button>
                    <button id="btn-stop-game" style="background-color: #f44336;">‚ùå Avslutt √òving</button>
                </div>
                
                <div id="learning-status">Status: Ventet p√• opptak...</div>
            </div>
        </section>

        <!-- Noteark-seksjon -->
        <section id="sheet-container">
            <h3>Noteark (Klikk p√• en note for √• endre den):</h3>
            <div id="sheet-music-scroll">
                <div id="vexflow-wrapper"></div>
            </div>
        </section>

        <!-- MIDI Visualizer (Canvas for fallende noter) -->
        <section id="midi-visualizer-container">
            <canvas id="falling-notes-canvas"></canvas>
        </section>

        <!-- Piano-seksjon -->
        <section id="piano-container">
            <div class="piano" id="piano"></div>
        </section>

        <!-- Logg-seksjon -->
        <section id="logging-area">
            <h3>Logg:</h3>
            <div id="app-log"></div>
        </section>
    </div>

    <!-- CONTEXT MENU -->
    <div id="note-context-menu" class="context-menu" style="display: none;">
        <h4>Rediger Note</h4>
        <div class="menu-section">
            <button class="menu-btn" onclick="modifySelectedNote('duration', 'w')">Helnote</button>
            <button class="menu-btn" onclick="modifySelectedNote('duration', 'h')">Halvnote</button>
            <button class="menu-btn" onclick="modifySelectedNote('duration', 'q')">Fjerdedel</button>
            <button class="menu-btn" onclick="modifySelectedNote('duration', '8')">√Öttedel</button>
        </div>
        <div class="menu-section">
            <button class="menu-btn" onclick="modifySelectedNote('dot')">Av/P√• Punktum</button>
            <button class="menu-btn" onclick="modifySelectedNote('type')">Bytt Note/Pause</button>
            <button class="menu-btn delete-btn" onclick="modifySelectedNote('delete')">Slett Note</button>
        </div>
        <button class="menu-close" onclick="closeContextMenu()">Lukk</button>
    </div>

    <script src="script.js"></script>
</body>
</html>
<!-- Version: #36 -->
